<link rel="stylesheet" href="/assets/css/settings/user/security.css">

<div class="security-container">
    <!--BEGIN: 2FA Settings -->
{{?!this.user.mfa}}
    <div class="card mfa_settings danger">
        <div class="card-header">
            <h2 class="card-title">Two-Factor Authentication</h2>
            <i class="fas fa-shield-alt fa-2x fa-fw text-white"></i>
        </div>
        <div class="card-body">
            <p class="text-bold">Two-Factor Authentication is currently disabled on your account!</p>
            <p>We highly recommend to enable two-factory authentication to add extra security to your account.</p>
            <p>To enable 2FA, click the button below.</p>
        </div>
        <div class="card-footer">
            <button class="btn btn-2x success" id="btn_2fa_enable">Enable</button>
        </div>
        <div class="card-overlay d-none">
            <div class="lds-ring">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
    </div>
{{/?}}
{{?this.user.mfa}}
    <div class="card mfa_settings success">
        <div class="card-header">
            <h2 class="card-title">2FA Settings</h2>
            <i class="fas fa-check fa-2x fa-fw text-white"></i>
        </div>
        <div class="card-body">
            <p>2FA is enabled</p>
        </div>
        <div class="card-footer">
            <button class="btn btn-2x danger" id="btn_2fa_disable">Disable 2FA</button>
        </div>
        <div class="card-overlay d-none">
            <div class="lds-ring">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
    </div>
{{/?}}
    <!--END: 2FA Settings -->

    <!--BEGIN: Password -->

    <div class="card password_settings">
        <div class="card-header">
            <h2 class="card-title">Change password</h2>
            <i class="fas fa-lock fa-2x fa-fw text-white"></i>
        </div>
        <div class="card-body">
            <input type="password" name="current_password" placeholder="Current password">
            <input type="password" name="new_password" placeholder="New password">
            <input type="password" name="confirm_password" placeholder="Config password">
        </div>
        <div class="card-footer">
            <button class="btn btn-2x success">Save</button>
        </div>
    </div>

    <!--End: Password -->

{{?!this.user.mfa}}
    <modal mid="enable2fa" class="d-none">
        <div class="d-flex flex-column">
            <div class="card secondary no-shadow">
                <div class="card-header">
                    <h2 class="card-title">Apps for 2FA-Tokens</h2>
                </div>
                <div class="card-body">
                    <div class="app">
                        <span>Google Authenticator</span>
                        <div class="appstores">
                            <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2">
                                <img src="https://cdn.w-mi.de/icons/google/en_badge_web_generic.png" alt="Get it on Google Play" class="google_play">
                            </a>
                            <a href="https://apps.apple.com/de/app/google-authenticator/id388497605">
                                <img src="https://cdn.w-mi.de/icons/apple/Download-on-the-App-Store/US/Download_on_App_Store/Black_lockup/SVG/Download_on_the_App_Store_Badge_US-UK_RGB_blk_092917.svg" alt="Download on the AppStore" class="appstore">
                            </a>
                        </div>
                    </div>
                    <div class="app">
                        <span>Microsoft Authenticator</span>
                        <div class="appstores">
                            <a href="https://play.google.com/store/apps/details?id=com.azure.authenticator">
                                <img src="https://cdn.w-mi.de/icons/google/en_badge_web_generic.png" alt="Get it on Google Play" class="google_play">
                            </a>
                            <a href="https://apps.apple.com/de/app/microsoft-authenticator/id983156458">
                                <img src="https://cdn.w-mi.de/icons/apple/Download-on-the-App-Store/US/Download_on_App_Store/Black_lockup/SVG/Download_on_the_App_Store_Badge_US-UK_RGB_blk_092917.svg" alt="Download on the AppStore" class="appstore">
                            </a>
                        </div>
                    </div>
                    <div class="app">
                        <span>Twilio Authy Authenticator</span>
                        <div class="appstores">
                            <a href="https://play.google.com/store/apps/details?id=com.authy.authy">
                                <img src="https://cdn.w-mi.de/icons/google/en_badge_web_generic.png" alt="Get it on Google Play" class="google_play">
                            </a>
                            <a href="https://apps.apple.com/de/app/twilio-authy/id494168017">
                                <img src="https://cdn.w-mi.de/icons/apple/Download-on-the-App-Store/US/Download_on_App_Store/Black_lockup/SVG/Download_on_the_App_Store_Badge_US-UK_RGB_blk_092917.svg" alt="Download on the AppStore" class="appstore">
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card primary mfa_settings no-shadow">
            <div class="card-header">
                <h2 class="card-title">Enabling 2FA</h2>
            </div>
            <div class="card-body">

                <p>To enable two-factor authentication, scan the QR-Code or enter the secret below in your preferred authenticator app</p>
                <img draggable="false" src="https://cdn.w-mi.de/icons/fontawesome/svgs/solid/qrcode.svg" alt="2FA Secret QRCode">
                <span class="mfa_secret_text"></span>

                <div class="twoFA_input">
                    <span class="error_message">Wrong token. Please try again.</span>
                    <div class="fields">
                        <input type="number" name="digit_0" min="0" max="9" maxlength="1" placeholder="X" autofocus>
                        <input type="number" name="digit_1" min="0" max="9" maxlength="1" placeholder="X">
                        <input type="number" name="digit_2" min="0" max="9" maxlength="1" placeholder="X">
                        <input type="number" name="digit_3" min="0" max="9" maxlength="1" placeholder="X">
                        <input type="number" name="digit_4" min="0" max="9" maxlength="1" placeholder="X">
                        <input type="number" name="digit_5" min="0" max="9" maxlength="1" placeholder="X">
                    </div>

                </div>
            </div>
            <div class="card-footer">
                <button class="btn btn-2x success" id="modal_enable_2fa">Enable 2FA</button>
            </div>
            <div class="card-overlay">
                <div class="lds-ring">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
        </div>
    </modal>
{{/?}}
{{?this.user.mfa}}
    <modal mid="disable2fa" class="d-none">
        <div class="card danger no-shadow">
            <div class="card-header">
                <h2 class="card-title">Disable 2FA</h2>
            </div>
            <div class="card-body">
                <p class="text-bold">Are you sure?</p>
                <p>By disabling two-factory authentication you increase the risk of other people accessing your account.</p>
            </div>
            <div class="card-footer">
                <button class="btn btn-2x danger" id="modal_disable_2fa">Disable</button>
            </div>
            <div class="card-overlay d-none">
                <div class="lds-ring">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
        </div>
    </modal>
{{/?}}



</div>
